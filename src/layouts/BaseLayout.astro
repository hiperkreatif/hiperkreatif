---
import { NAV_LOGO, NAV_MENU, NAV_CTA } from "../constants/navbar.ts";
import "../styles/global.css";
import Analytics from "@vercel/analytics/astro";

import { Picture } from "astro:assets";
import Logo from "../assets/logo-black.svg";
import { ClientRouter } from "astro:transitions";
import { SEO as DEFAULTS } from "../constants/seo.ts";
import og from "../assets/og.png";
const ogUrl = new URL(og.src, Astro.site).toString();

const {
  title = DEFAULTS.title,
  description = DEFAULTS.description,
  robots = DEFAULTS.robots,
  //   ogImage = DEFAULTS.ogImage,
  ogImageAlt = DEFAULTS.ogImageAlt,
  ogType = DEFAULTS.ogType,
  twitterCard = DEFAULTS.twitterCard,
  siteName = DEFAULTS.siteName,
} = Astro.props;

// Canonical per halaman, bukan hardcode:
const canonicalURL = new URL(Astro.url.pathname, Astro.site);
---

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>{title}</title>
    <meta name="description" content={description} />
    <meta name="robots" content={robots} />
    <link rel="canonical" href={canonicalURL} />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />

    <!-- Open Graph -->
    <meta property="og:type" content={ogType} />
    <meta property="og:site_name" content={siteName} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogUrl} />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content={ogImageAlt} />
    <meta property="og:url" content={Astro.url.href} />

    <!-- Twitter -->
    <meta name="twitter:card" content={twitterCard} />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogUrl} />

    <!-- Optional: bantu crawler nemuin sitemap -->
    <link rel="sitemap" href="/sitemap-index.xml" />

    <!-- Router + prefetch -->
    <ClientRouter />
  </head>
  <body class="min-h-screen bg-white text-gray-900">
    <header
      transition:name="site-header"
      class="sticky top-0 z-50 bg-transparent backdrop-blur-xl border-b border-gray-100"
    >
      <nav>
        <div
          class="max-w-6xl mx-auto flex items-center justify-between px-6 sm:px-0 py-4"
        >
          <a href="/" class="flex items-center gap-3 group">
            <Picture
              src={Logo}
              alt="Logo Hiperkreatif"
              widths={[48, 48]}
              sizes="(min-width: 768px) 48px, 48px"
              class="h-10 w-10 md:h-12 md:w-12 transition-transform duration-300 group-hover:scale-110"
            />
            <span
              class="font-bold text-2xl md:text-3xl bg-clip-text text-transparent bg-gradient-to-r from-slate-900 to-gray-400"
              >{NAV_LOGO}</span
            >
          </a>

          {/* Desktop Menu */}
          <div class="hidden md:flex items-center gap-6">
            {
              NAV_MENU.map((item) => (
                <a
                  href={item.href}
                  class="relative text-base text-gray-600 font-medium px-2 py-1 hover:text-black transition-colors after:absolute after:left-0 after:bottom-0 after:h-0.5 after:w-0 after:bg-black after:transition-all hover:after:w-full"
                  target={item.external ? "_blank" : undefined}
                  rel={item.external ? "noopener" : undefined}
                >
                  {item.label}
                </a>
              ))
            }
            <a
              href={NAV_CTA.href}
              class="ml-4 bg-black text-white font-medium text-base px-6 py-2.5 rounded-full shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300"
              >{NAV_CTA.label}</a
            >
          </div>

          {/* Mobile Menu Button */}
          <button
            class="md:hidden p-2 text-gray-600 hover:text-black focus:outline-none rounded-full hover:bg-gray-100 transition-colors"
            onclick="document.getElementById('mobile-menu').classList.toggle('hidden')"
            aria-label="Toggle mobile menu"
            aria-expanded="false"
            aria-controls="mobile-menu"
          >
            <svg
              class="h-6 w-6"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
        </div>

        {/* Mobile Menu Panel */}
        <div id="mobile-menu" class="hidden md:hidden">
          <div
            class="px-6 pt-4 pb-6 space-y-3 bg-gray-50/80 backdrop-blur-lg border-t border-gray-100"
          >
            {
              NAV_MENU.map((item) => (
                <a
                  href={item.href}
                  class="block text-base text-gray-600 hover:text-black font-medium px-3 py-2.5 rounded-lg hover:bg-white transition-all"
                  target={item.external ? "_blank" : undefined}
                  rel={item.external ? "noopener" : undefined}
                >
                  {item.label}
                </a>
              ))
            }
            <a
              href={NAV_CTA.href}
              class="block mt-6 bg-black text-white font-medium text-base px-6 py-3 rounded-full text-center shadow-lg hover:shadow-xl hover:scale-[1.02] transition-all duration-300"
              >{NAV_CTA.label}</a
            >
          </div>
        </div>
      </nav>
    </header>
    <main class="container mx-auto px-6">
      <slot />
    </main>
    <footer
      transition:name="site-footer"
      class="mt-12 py-6 border-t border-gray-200 bg-white text-center text-sm text-gray-500"
    >
      &copy; {new Date().getFullYear()} Hiperkreatif. All rights reserved.
    </footer>
    <Analytics />
  </body>
</html>
