---
import { SEO } from '../constants/seo';
import BaseLayout from '../layouts/BaseLayout.astro';
import { PRODUCTS } from '../constants/products';
---

<BaseLayout>
  <section class="mt-32 flex flex-col items-center justify-center text-center px-4">

    <div class="absolute inset-0 -z-10 w-full">
      <img
        src="/src/assets/bg-pattern.png"
        alt="Background pattern"
        class="w-full h-full object-cover opacity-20"
      />
    </div>
    <h1 class="text-4xl md:text-5xl font-bold mb-2 text-gray-900 tracking-tight leading-tight">
      {SEO.heroTitle}
    </h1>
    <p class="text-base md:text-lg text-gray-600 mb-6 max-w-2xl">
      {SEO.description}
    </p>
    <form id="searchForm" class="flex w-full max-w-md mx-auto" role="search">
      <input
        type="search"
        placeholder="Cari produk, tools, atau layanan..."
        class="flex-1 rounded px-3 py-2 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-black text-base bg-white shadow-sm"
        aria-label="Cari produk, tools, atau layanan"
      />
    </form>
  </section>
  <section class="px-4 sm:px-0 mt-18">
    <script type="module" src="/scripts/tagFilter.js"></script>
    <!-- Tag Filter -->
    <div id="tag-filter" class="flex flex-wrap gap-2 mb-4 overflow-x-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent md:justify-center md:overflow-visible">
      {Array.from(new Set(PRODUCTS.flatMap(p => p.tags))).map(tag => (
        <button
          class={`px-3 py-1 rounded-full border text-sm font-medium transition-colors whitespace-nowrap
            bg-white text-gray-700 border-gray-300 hover:bg-gray-100
            data-[selected=true]:bg-black data-[selected=true]:text-white data-[selected=true]:border-black data-[selected=true]:hover:bg-black data-[selected=true]:hover:text-white data-[selected=true]:hover:border-black`}
          type="button"
          data-tag={tag}
          data-selected="false"
        >
          {tag}
        </button>
      ))}
    </div>
    <!-- Product List -->
    <div id="product-list" class="grid grid-cols-1 gap-4 sm:grid-cols-2 md:grid-cols-3">
      {PRODUCTS.map(product => (
        <a href={product.url} target="_blank" rel="noopener" class="bg-white rounded-xl shadow-sm p-3 flex flex-col border border-gray-100 hover:shadow-md transition-shadow cursor-pointer no-underline">
          <img src={product.thumbnail} alt={product.title} class="w-full h-32 object-cover rounded mb-3 flex-shrink-0" loading="lazy" />
          <h3 class="text-base font-semibold mb-1 text-gray-900 text-left">{product.title}</h3>
          <p class="text-sm text-gray-500 text-justify mb-2 line-clamp-5">{product.description}</p>
          <div class="flex flex-wrap gap-1 mb-1">
            {product.tags.map(tag => (
              <span class="px-2 py-0.5 bg-gray-100 text-gray-600 rounded-full text-xs font-medium">{tag}</span>
            ))}
          </div>
        </a>
      ))}
    </div>
  </section>
</BaseLayout>
